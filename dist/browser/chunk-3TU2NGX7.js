import{a as F}from"./chunk-IYNE3RVJ.js";import{a as L}from"./chunk-GKTJ3MPG.js";import{l as x}from"./chunk-Y6UGLKWX.js";import{a as T,b as V,d as W,g as O,i as N,o as A,p as D,q as k,v as B}from"./chunk-JYF56DXZ.js";import{Ab as b,Bb as h,Eb as f,Fc as I,Kb as l,Lb as P,Mb as v,Qb as u,Rb as g,Sb as _,Ta as d,Za as y,ba as s,ca as p,db as E,hb as S,ob as m,tb as r,ub as n,vc as w,wc as M,zb as C}from"./chunk-VE4VNBXX.js";import"./chunk-EQDQRRRY.js";function R(c,a){if(c&1&&(r(0,"option",9),l(1),n()),c&2){let e=a.$implicit;m("value",e.storeId),d(),v(" ",e.name," ")}}function U(c,a){if(c&1){let e=C();r(0,"tr")(1,"td"),l(2),n(),r(3,"td")(4,"input",13),_("ngModelChange",function(i){let o=s(e).$implicit;return g(o.category,i)||(o.category=i),p(i)}),n()(),r(5,"td")(6,"input",13),_("ngModelChange",function(i){let o=s(e).$implicit;return g(o.description,i)||(o.description=i),p(i)}),n()(),r(7,"td",11)(8,"input",14),_("ngModelChange",function(i){let o=s(e).$implicit;return g(o.isActive,i)||(o.isActive=i),p(i)}),n()(),r(9,"td",15)(10,"input",16),_("ngModelChange",function(i){let o=s(e).$implicit;return g(o.price,i)||(o.price=i),p(i)}),n()(),r(11,"td",17)(12,"input",13),_("ngModelChange",function(i){let o=s(e).$implicit;return g(o.barcode,i)||(o.barcode=i),p(i)}),n()()()}if(c&2){let e=a.$implicit,t=a.index;d(2),P(e.productName),d(2),f("name","category",t,""),u("ngModel",e.category),d(2),f("name","description",t,""),u("ngModel",e.description),d(2),f("name","active",t,""),u("ngModel",e.isActive),d(2),f("name","price",t,""),u("ngModel",e.price),d(2),f("name","barcode",t,""),u("ngModel",e.barcode)}}function $(c,a){if(c&1&&(r(0,"table",10)(1,"thead")(2,"tr")(3,"th"),l(4,"Name"),n(),r(5,"th"),l(6,"Category"),n(),r(7,"th"),l(8,"Description"),n(),r(9,"th",11),l(10,"Active"),n(),r(11,"th"),l(12,"Price"),n(),r(13,"th"),l(14,"Barcode"),n()()(),r(15,"tbody"),S(16,U,13,16,"tr",12),n()()),c&2){let e=h();d(16),m("ngForOf",e.products)}}function q(c,a){if(c&1){let e=C();r(0,"button",18),b("click",function(){s(e);let i=h();return p(i.submitChanges())}),l(1," Submit Changes "),n()}}function z(c,a){c&1&&(r(0,"div",19),l(1," No products for this store. "),n())}var j=class c{constructor(a,e){this.storeSvc=a;this.productSvc=e}stores=[];selectedStoreId="";products=[];ngOnInit(){this.storeSvc.getStores().subscribe(a=>this.stores=a)}onStoreChange(a){if(this.selectedStoreId=a,!a){this.products=[];return}this.storeSvc.getStoreProducts(a).subscribe(e=>this.products=e)}submitChanges(){let a=this.products.map(e=>{let t=parseFloat(String(e.price).replace(",","."));return{storePriceId:e.storePriceId,storeId:e.storeId,productId:e.productId,productName:e.productName,category:e.category,description:e.description,price:t,barcode:e.barcode??"",isActive:e.isActive}});this.productSvc.bulkAddProducts(a).subscribe({next:e=>{e.success?alert(`Successfully updated ${e.count} products.`):alert(`Validation failed:
${e.errors?.join(`
`)}`)},error:e=>{let t=e.error;t?.errors?alert(`Server error (${e.status}):
${t.errors.join(`
`)}`):alert(`Unexpected error (${e.status}): ${e.message}`)}})}static \u0275fac=function(e){return new(e||c)(y(F),y(L))};static \u0275cmp=E({type:c,selectors:[["app-edit-products"]],decls:13,vars:5,consts:[[1,"container","mt-4"],[1,"mb-3","col-md-4"],[1,"form-label"],["name","storeSelect",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","table table-striped mt-3",4,"ngIf"],["class","btn btn-primary mt-2",3,"click",4,"ngIf"],["class","alert alert-info mt-2",4,"ngIf"],[3,"value"],[1,"table","table-striped","mt-3"],[1,"text-center"],[4,"ngFor","ngForOf"],["type","text",1,"form-control","form-control-sm",3,"ngModelChange","ngModel","name"],["type","checkbox",1,"form-check-input",3,"ngModelChange","ngModel","name"],[2,"max-width","100px"],["type","number",1,"form-control","form-control-sm",3,"ngModelChange","ngModel","name"],[2,"max-width","120px"],[1,"btn","btn-primary","mt-2",3,"click"],[1,"alert","alert-info","mt-2"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2"),l(2,"Edit Products"),n(),r(3,"div",1)(4,"label",2),l(5,"Store"),n(),r(6,"select",3),_("ngModelChange",function(o){return g(t.selectedStoreId,o)||(t.selectedStoreId=o),o}),b("ngModelChange",function(o){return t.onStoreChange(o)}),r(7,"option",4),l(8,"-- Select a store --"),n(),S(9,R,2,2,"option",5),n()(),S(10,$,17,1,"table",6)(11,q,2,0,"button",7)(12,z,2,0,"div",8),n()),e&2&&(d(6),u("ngModel",t.selectedStoreId),d(3),m("ngForOf",t.stores),d(),m("ngIf",t.products.length),d(),m("ngIf",t.products.length),d(),m("ngIf",t.selectedStoreId&&!t.products.length))},dependencies:[I,w,M,B,D,k,V,N,T,A,W,O,x],encapsulation:2})};export{j as EditProductsComponent};

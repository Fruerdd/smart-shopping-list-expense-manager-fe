import{a as o,b as u}from"./chunk-4RDB7OU6.js";import{Mc as c,R as h,W as n,k as p,n as l,y as t}from"./chunk-TZJJSUIX.js";var g=class a{constructor(r,e){this.http=r;this.authService=e}apiUrl=`${o.apiUrl}/user`;getUserProfile(r){return this.http.get(`${this.apiUrl}/profile/${r}`).pipe(t(this.handleError))}getCurrentUserProfile(){return this.http.get(`${this.apiUrl}/profile/me`).pipe(t(r=>(r.status===403&&this.authService.logout(),this.handleError(r))))}getUserProfileById(r){return this.http.get(`${this.apiUrl}/profile/${r}`).pipe(t(this.handleError))}getUsersByIds(r){return this.http.post(`${o.apiUrl}/api/users/bulk`,{userIds:r}).pipe(t(this.handleError))}getUserStatistics(r){return this.http.get(`${this.apiUrl}/statistics/${r}`).pipe(t(this.handleError))}updateUserProfile(r,e){return this.http.patch(`${this.apiUrl}/profile/${r}`,e).pipe(t(this.handleError))}getUserFriends(r){return this.http.get(`${this.apiUrl}/friends/${r}`).pipe(t(this.handleError))}getLoyaltyPoints(r){return this.http.get(`${this.apiUrl}/profile/loyalty-points/${r}`).pipe(t(this.handleError))}updateLoyaltyPoints(r,e){return this.http.put(`${this.apiUrl}/profile/loyalty-points/${r}`,null,{params:{points:e.toString()}}).pipe(t(this.handleError))}getUserReviews(r){return this.http.get(`${this.apiUrl}/profile/reviews/${r}`).pipe(t(this.handleError))}updateUserReview(r,e){return this.http.post(`${this.apiUrl}/profile/reviews/${r}`,e).pipe(t(this.handleError))}applyReferralCode(r,e){return this.http.post(`${this.apiUrl}/profile/referral/${r}`,null,{params:{referralCode:e},responseType:"text"}).pipe(t(this.handleError))}getUserReferralCode(r){return this.http.get(`${this.apiUrl}/profile/referral-code/${r}`,{responseType:"text"}).pipe(t(this.handleError))}awardLoyaltyPoints(r,e,i=1){return this.http.post(`${this.apiUrl}/profile/award-points/${r}`,null,{params:{activity:e,count:i.toString()},responseType:"text"}).pipe(t(this.handleError))}uploadProfilePicture(r,e){let i=new FormData;return i.append("file",e),this.http.post(`${this.apiUrl}/profile/upload-picture/${r}`,i,{responseType:"text"}).pipe(t(this.handleError))}searchUsers(r){return this.http.get(`${this.apiUrl}/search`,{params:{q:r}}).pipe(t(this.handleError))}sendFriendRequest(r,e){return this.http.post(`${this.apiUrl}/friends/${r}/request`,null,{params:{friendId:e},responseType:"text"}).pipe(t(this.handleError))}acceptFriendRequest(r,e){return this.http.post(`${this.apiUrl}/friends/${r}/accept`,null,{params:{requesterId:e},responseType:"text"}).pipe(t(this.handleError))}declineFriendRequest(r,e){return this.http.post(`${this.apiUrl}/friends/${r}/decline`,null,{params:{requesterId:e},responseType:"text"}).pipe(t(this.handleError))}removeFriend(r,e){return this.http.delete(`${this.apiUrl}/friends/${r}/remove`,{params:{friendId:e},responseType:"text"}).pipe(t(this.handleError))}getUserNotifications(r){return this.http.get(`${this.apiUrl}/notifications/${r}`).pipe(t(this.handleError))}getUnreadNotifications(r){return this.http.get(`${this.apiUrl}/notifications/${r}/unread`).pipe(t(this.handleError))}getUnreadNotificationCount(r){return this.http.get(`${this.apiUrl}/notifications/${r}/count`).pipe(l(e=>typeof e=="number"?e:parseInt(e.toString())),t(this.handleError))}markNotificationAsRead(r){return this.http.patch(`${this.apiUrl}/notifications/${r}/read`,null,{responseType:"text"}).pipe(t(this.handleError))}markAllNotificationsAsRead(r){return this.http.patch(`${this.apiUrl}/notifications/${r}/read-all`,null,{responseType:"text"}).pipe(t(this.handleError))}handleError(r){let e="An error occurred";if(r.error instanceof ErrorEvent)e=r.error.message;else{let i="";if(typeof r.error=="string")try{let s=JSON.parse(r.error);i=s.message||s.error||""}catch{i=r.error}else r.error&&typeof r.error=="object"&&(i=r.error.message||r.error.error||"");if(i&&i.includes('"')){let s=i.match(/"([^"]+)"/);s&&s[1]?e=s[1]:e=i}else if(i)e=i;else switch(r.status){case 400:e="Bad request. Please check your input.";break;case 401:e="Unauthorized. Please log in again.";break;case 403:e="You do not have permission to access this resource.";break;case 404:e="Resource not found.";break;case 409:e="Conflict. Resource already exists or has been used.";break;case 500:e="Server error occurred. Please try again later.";break;default:e=`Error ${r.status}: ${r.message}`}}return console.error("Error in UserProfileService:",e),p(()=>new Error(e))}static \u0275fac=function(e){return new(e||a)(n(c),n(u))};static \u0275prov=h({token:a,factory:a.\u0275fac,providedIn:"root"})};export{g as a};
